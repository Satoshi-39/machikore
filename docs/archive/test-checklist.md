# ãƒ†ã‚¹ãƒˆãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

## ğŸ“‹ ç¢ºèªæ‰‹é †

### 1. ã‚¢ãƒ—ãƒªèµ·å‹•ç¢ºèª

```bash
npx expo run:ios
```

**ãƒã‚§ãƒƒã‚¯é …ç›®**:
- [ ] ã‚¢ãƒ—ãƒªãŒèµ·å‹•ã™ã‚‹
- [ ] ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã—ãªã„
- [ ] ãƒ›ãƒ¼ãƒ ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ã‚¨ãƒ©ãƒ¼ãŒå‡ºãªã„

---

### 2. SQLiteã¸ã®ãƒ‡ãƒ¼ã‚¿æ›¸ãè¾¼ã¿ç¢ºèª

#### æ–¹æ³•1: æ—¢å­˜æ©Ÿèƒ½ã§è¨ªå•è¨˜éŒ²ã‚’ä½œæˆ

1. ã‚¢ãƒ—ãƒªã§è¡—ã‚’é¸æŠ
2. ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³/è¨ªå•è¨˜éŒ²ã‚’ä½œæˆ
3. ãƒ‡ãƒ¼ã‚¿ãŒå³åº§ã«è¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

#### æ–¹æ³•2: é–‹ç™ºè€…ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ç¢ºèª

**Expo Dev Tools ã‚’é–‹ã**:
```bash
# ã‚¢ãƒ—ãƒªèµ·å‹•ä¸­ã«ã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ "m" ã‚’æŠ¼ã™
# â†’ Chrome Developer Tools ãŒé–‹ã
```

**ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§å®Ÿè¡Œ**:
```javascript
// ã‚°ãƒ­ãƒ¼ãƒãƒ«é–¢æ•°ã‚’ç™»éŒ²ï¼ˆapp/_layout.tsx ã§è¨­å®šæ¸ˆã¿ï¼‰
checkSQLite();
```

**æœŸå¾…ã™ã‚‹çµæœ**:
```
ğŸ“Š ===== SQLite Data Check =====

ğŸ“ æœ€æ–°ã®è¨ªå•è¨˜éŒ² (5ä»¶):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ (index) â”‚          id          â”‚   user_id   â”‚  machi_id  â”‚is_synced â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    0    â”‚ 'visit-abc-123'      â”‚ 'user-001'  â”‚'machi-xyz' â”‚    0     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ”„ æœªåŒæœŸãƒ¬ã‚³ãƒ¼ãƒ‰: 1ä»¶
```

**ç¢ºèªãƒã‚¤ãƒ³ãƒˆ**:
- [ ] è¨ªå•è¨˜éŒ²ãŒå­˜åœ¨ã™ã‚‹
- [ ] `is_synced = 0` ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒã‚ã‚‹ï¼ˆåŒæœŸå¾…ã¡ï¼‰
- [ ] `created_at` ãŒæœ€è¿‘ã®æ—¥æ™‚

---

### 3. åŒæœŸã‚­ãƒ¥ãƒ¼ã®ç¢ºèª

**ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§å®Ÿè¡Œ**:
```javascript
checkSQLite();
```

**æœŸå¾…ã™ã‚‹çµæœ**:
```
ğŸ“® åŒæœŸã‚­ãƒ¥ãƒ¼: 1ä»¶
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ (index) â”‚          id          â”‚ entity_type â”‚ operation  â”‚  status  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    0    â”‚ 'queue-abc-123'      â”‚  'visits'   â”‚  'create'  â”‚ 'pending'â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ³¨æ„**: ç¾åœ¨ã®å®Ÿè£…ã§ã¯ã€sync_queue ã¯**å°†æ¥ã®å®Ÿè£…**ç”¨ã§ã™ã€‚
ã¾ãšã¯ `visits.is_synced` ãƒ•ãƒ©ã‚°ã§ç¢ºèªã—ã¦ãã ã•ã„ã€‚

---

### 4. æ‰‹å‹•åŒæœŸã®ãƒˆãƒªã‚¬ãƒ¼

**æ–¹æ³•1: ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯çŠ¶æ…‹ã‚’å¤‰æ›´**

1. æ©Ÿå†…ãƒ¢ãƒ¼ãƒ‰ON
2. è¨ªå•è¨˜éŒ²ã‚’ä½œæˆ
3. æ©Ÿå†…ãƒ¢ãƒ¼ãƒ‰OFF
4. ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ä»¥ä¸‹ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª:

```
ğŸ“¶ Network state changed: { status: 'online', isInternetReachable: true }
ğŸ”„ Starting sync...
ğŸ“¤ Syncing 1 items...
âœ… Synced visits:visit-abc-123
âœ… Sync completed: { syncedCount: 1, failedCount: 0 }
```

**æ–¹æ³•2: ã‚¢ãƒ—ãƒªå†…ã§æ‰‹å‹•åŒæœŸãƒœã‚¿ãƒ³ï¼ˆå°†æ¥å®Ÿè£…ï¼‰**

ç¾åœ¨ã¯ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å¾©å¸°æ™‚ã®è‡ªå‹•åŒæœŸã®ã¿å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚

---

### 5. Supabaseã¸ã®åŒæœŸç¢ºèª

#### æ–¹æ³•A: Supabase Dashboardï¼ˆæ¨å¥¨ï¼‰

1. **Supabase Dashboard ã‚’é–‹ã**
   ```
   https://supabase.com/dashboard/project/YOUR_PROJECT_ID
   ```

2. **Table Editor â†’ visits ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’é–‹ã**

3. **ç¢ºèªé …ç›®**:
   - [ ] åŒæœŸã—ãŸãƒ¬ã‚³ãƒ¼ãƒ‰ãŒå­˜åœ¨ã™ã‚‹
   - [ ] `user_id`, `machi_id`, `visit_count` ãŒæ­£ã—ã„
   - [ ] `created_at`, `updated_at` ãŒã‚ã‚‹

**ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆä¾‹**:
```
| id              | user_id   | machi_id    | visit_count | created_at          |
|-----------------|-----------|-------------|-------------|---------------------|
| visit-abc-123   | user-001  | machi-xyz   | 1           | 2025-11-12 16:45:00 |
```

#### æ–¹æ³•B: ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ç¢ºèªï¼ˆé–‹ç™ºç”¨ï¼‰

**ã‚¢ãƒ—ãƒªã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§å®Ÿè¡Œ**:
```javascript
// Supabaseã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿å–å¾—
const checkSupabase = async () => {
  const { supabase } = await import('@/shared/api/supabase/client');
  const { data, error } = await supabase
    .from('visits')
    .select('*')
    .order('created_at', { ascending: false })
    .limit(5);

  if (error) {
    console.error('âŒ Supabase Error:', error);
  } else {
    console.log('âœ… Supabase Data:');
    console.table(data);
  }
};

checkSupabase();
```

---

## ğŸ¯ æˆåŠŸã®åˆ¤å®šåŸºæº–

### âœ… ã™ã¹ã¦æˆåŠŸ

- [x] ã‚¢ãƒ—ãƒªãŒèµ·å‹•ã™ã‚‹
- [x] SQLiteã«ãƒ‡ãƒ¼ã‚¿ãŒæ›¸ãè¾¼ã¾ã‚Œã‚‹ï¼ˆ`is_synced = 0`ï¼‰
- [x] ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å¾©å¸°æ™‚ã«åŒæœŸãŒå®Ÿè¡Œã•ã‚Œã‚‹
- [x] SQLiteã® `is_synced` ãŒ 1 ã«ãªã‚‹
- [x] Supabaseã«ãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã™ã‚‹

### âš ï¸ éƒ¨åˆ†çš„ã«æˆåŠŸ

**ãƒ‘ã‚¿ãƒ¼ãƒ³1: åŒæœŸãŒå®Ÿè¡Œã•ã‚Œãªã„**
- SQLiteã«ãƒ‡ãƒ¼ã‚¿ã¯ã‚ã‚‹ãŒã€Supabaseã«ãªã„
- `is_synced = 0` ã®ã¾ã¾

**åŸå› å€™è£œ**:
1. ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šãŒãªã„
2. Supabaseèªè¨¼ã‚¨ãƒ©ãƒ¼ï¼ˆ`.env` è¨­å®šç¢ºèªï¼‰
3. RLSï¼ˆRow Level Securityï¼‰ãƒãƒªã‚·ãƒ¼ã§æ‹’å¦ã•ã‚Œã¦ã„ã‚‹

**è§£æ±ºç­–**:
```bash
# 1. .env ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª
cat .env | grep SUPABASE

# 2. Supabase Dashboard ã§ RLS ã‚’ç¢ºèª
# Table Editor â†’ visits â†’ Policies
# ã€ŒEnable RLSã€ãŒOFFã«ãªã£ã¦ã„ã‚‹ã‹ç¢ºèª
```

**ãƒ‘ã‚¿ãƒ¼ãƒ³2: SQLiteã¸ã®æ›¸ãè¾¼ã¿ãŒå¤±æ•—**
- ãƒ‡ãƒ¼ã‚¿ãŒä½œæˆã•ã‚Œãªã„
- ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹

**åŸå› å€™è£œ**:
1. ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒå®Ÿè¡Œã•ã‚Œã¦ã„ãªã„
2. ãƒ†ãƒ¼ãƒ–ãƒ«ãŒå­˜åœ¨ã—ãªã„

**è§£æ±ºç­–**:
```bash
# ã‚¢ãƒ—ãƒªã‚’å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npx expo run:ios
```

---

## ğŸ› ãƒ‡ãƒãƒƒã‚°ã‚³ãƒãƒ³ãƒ‰é›†

### SQLite ã®ä¸­èº«ã‚’ç¢ºèª
```javascript
// é–‹ç™ºè€…ã‚³ãƒ³ã‚½ãƒ¼ãƒ«
checkSQLite();
```

### åŒæœŸã‚’æ‰‹å‹•ã§å®Ÿè¡Œ
```javascript
// é–‹ç™ºè€…ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ï¼ˆå°†æ¥å®Ÿè£…ï¼‰
triggerSyncManually();
```

### ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯çŠ¶æ…‹ã‚’ç¢ºèª
```javascript
// é–‹ç™ºè€…ã‚³ãƒ³ã‚½ãƒ¼ãƒ«
const { getNetworkState } = require('@/shared/lib/network/monitor');
getNetworkState().then(state => {
  console.log('Network State:', state);
});
```

### Providerã®çŠ¶æ…‹ã‚’ç¢ºèª
```javascript
// React Componentå†…
const { isSyncing, lastSyncTime } = useSync();
console.log('Syncing:', isSyncing);
console.log('Last Sync:', lastSyncTime);
```

---

## ğŸ“ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### ã™ã¹ã¦æˆåŠŸã—ãŸã‚‰:
1. âœ… ç¾åœ¨ã®å®Ÿè£…ã‚’ã‚³ãƒŸãƒƒãƒˆ
2. â³ Post, User, Schedule ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã«ã‚‚é©ç”¨
3. â³ æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã‚’Repository Patternã«ç§»è¡Œ

### å•é¡ŒãŒã‚ã£ãŸã‚‰:
1. ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚³ãƒ”ãƒ¼
2. ä¸Šè¨˜ã®ãƒ‡ãƒãƒƒã‚°ã‚³ãƒãƒ³ãƒ‰ã§çŠ¶æ…‹ã‚’ç¢ºèª
3. å¿…è¦ã«å¿œã˜ã¦ä¿®æ­£
